@page
@model Shopping.Web.Pages.ProductListModel
@{
    ViewData["Title"] = "Products";
}

<div class="container-fluid px-lg-5 py-4">

    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb bg-light px-3 py-2 rounded-3 mb-4 border-0">
            <li class="breadcrumb-item"><a asp-page="Index">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page">Orders</li>
        </ol>
    </nav>

    <!-- Shop by Category -->
    <div class="bg-white rounded-4 shadow-sm p-4 mb-4">
        <h5 class="fw-bold text-muted mb-3"><i class="fa fa-bars me-2"></i> Shop by Category</h5>
        <div class="d-flex flex-wrap gap-2">
            @foreach (var category in Model.CategoryList)
            {
                var isSelected = category == Model.SelectedCategory;
                <a asp-page="ProductList" asp-route-categoryId="@category"
                   class="btn rounded-pill px-4 py-2 text-capitalize fw-medium
                          @(isSelected ? "btn-primary text-white" : "btn-outline-secondary")">
                    @category
                </a>
            }

        </div>
    </div>

    <div class="row g-5">
        <!-- Sidebar: Latest Product -->
        <aside class="col-12 col-md-4 col-lg-3">
            <div class="bg-white rounded-4 shadow-sm p-4 h-100">
                <h6 class="fw-semibold text-uppercase text-muted mb-4 small">
                    <i class="fa fa-clock me-2"></i> Latest Product
                </h6>

                @if (Model.ProductList?.Any() == true)
                {
                    var latest = Model.ProductList.Last();
                    <a asp-page="ProductDetail" asp-route-productId="@latest.Id" class="d-block mb-3">
                        <img class="img-fluid rounded-4 w-100"
                             src="~/images/product/@(string.IsNullOrEmpty(latest.ImageFile) ? "placeholder.png" : latest.ImageFile)"
                             alt="@latest.Name" asp-append-version="true" loading="lazy" />
                    </a>
                    <h6 class="fw-semibold text-dark lh-sm">@latest.Name</h6>
                    <p class="text-muted small mb-2">@((latest.Description?.Length ?? 0) > 50 ? latest.Description!.Substring(0, 50) + "..." : latest.Description)</p>
                    <span class="fw-bold text-danger">@latest.Price.ToString("0.00") $</span>
                }
            </div>
        </aside>

        <!-- Main Grid -->
        <section class="col-12 col-md-8 col-lg-9">
            <div class="row g-4">
                @foreach (var product in Model.ProductList!)
                {
                    <div class="col-12 col-sm-6 col-lg-4 mb-4">
                        <div class="rounded-4 p-3 shadow-sm bg-white d-flex flex-column h-100">
                            <partial name="_ProductItemPartial" model="@product" />
                        </div>
                    </div>
                }
            </div>

            <!-- Pagination Placeholder -->
            <div class="row mt-5">
                <div class="col">
                    <nav aria-label="Page navigation">
                        <ul class="pagination justify-content-center">
                            <li class="page-item disabled">
                                <span class="page-link rounded-pill">Previous</span>
                            </li>
                            <li class="page-item active">
                                <span class="page-link rounded-pill">1</span>
                            </li>
                            <li class="page-item">
                                <a class="page-link rounded-pill" href="#">2</a>
                            </li>
                            <li class="page-item">
                                <a class="page-link rounded-pill" href="#">3</a>
                            </li>
                            <li class="page-item">
                                <a class="page-link rounded-pill" href="#">Next</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </section>
    </div>
</div>
